diff -urN ppp-2.3.9.orig/chat/Makefile.linux ppp-2.3.9/chat/Makefile.linux
--- ppp-2.3.9.orig/chat/Makefile.linux	Fri Aug 13 15:59:36 1999
+++ ppp-2.3.9/chat/Makefile.linux	Fri Aug 13 16:01:59 1999
@@ -6,7 +6,7 @@
 CDEF4=	-DFNDELAY=O_NDELAY		# Old name value
 CDEFS=	$(CDEF1) $(CDEF2) $(CDEF3) $(CDEF4)
 
-CFLAGS=	-O2 -g -pipe $(CDEFS)
+CFLAGS=	-pipe $(CDEFS) -Wall $(RPM_OPT_FLAGS)
 
 INSTALL= install
 
diff -urN ppp-2.3.9.orig/linux/Makefile.top ppp-2.3.9/linux/Makefile.top
--- ppp-2.3.9.orig/linux/Makefile.top	Fri Aug 13 15:59:37 1999
+++ ppp-2.3.9/linux/Makefile.top	Fri Aug 13 15:59:53 1999
@@ -1,12 +1,12 @@
 # PPP top-level Makefile for Linux.
 
 
-BINDIR = /usr/sbin
-MANDIR = /usr/man
-ETCDIR = /etc/ppp
+BINDIR = $(TOPDIR)/usr/sbin
+MANDIR = $(TOPDIR)/usr/man
+ETCDIR = $(TOPDIR)/etc/ppp
 
 # uid 0 = root
-INSTALL= install -o 0 -g daemon
+INSTALL= install # -o 0 -g daemon
 
 all:
 	cd chat; $(MAKE) $(MFLAGS) all
@@ -14,7 +14,10 @@
 	cd pppstats; $(MAKE) $(MFLAGS) all
 	cd pppdump; $(MAKE) $(MFLAGS) all
 
-install: $(BINDIR) $(MANDIR)/man8 install-progs install-etcppp
+install: dirs install-progs install-etcppp
+
+dirs:
+	mkdir -p $(BINDIR) $(MANDIR)/man8 $(ETCDIR)
 
 install-progs:
 	cd chat; $(MAKE) BINDIR=$(BINDIR) MANDIR=$(MANDIR) $(MFLAGS) install
diff -urN ppp-2.3.9.orig/pppd/Makefile.linux ppp-2.3.9/pppd/Makefile.linux
--- ppp-2.3.9.orig/pppd/Makefile.linux	Fri Aug 13 15:59:38 1999
+++ ppp-2.3.9/pppd/Makefile.linux	Fri Aug 13 16:10:38 1999
@@ -4,8 +4,8 @@
 #
 
 # Default installation locations
-BINDIR = /usr/sbin
-MANDIR = /usr/man
+BINDIR = $(TOPDIR)/usr/sbin
+MANDIR = $(TOPDIR)/usr/man
 
 PPPDSRCS = main.c magic.c fsm.c lcp.c ipcp.c upap.c chap.c md5.c ccp.c \
 	   ipxcp.c auth.c options.c sys-linux.c md4.c chap_ms.c cbcp.c \
@@ -26,8 +26,8 @@
 
 # CC = gcc
 #
-COPTS = -O2 -pipe -Wall -g
-LIBS =
+COPTS = $(RPM_OPT_FLAGS) -pipe -Wall -g
+LIBS = -lutil
 
 ifneq ($(wildcard /usr/lib/libcrypt*),)
 LIBS += -lcrypt
@@ -43,7 +43,7 @@
 
 
 HAS_SHADOW=y
-#USE_PAM=y
+USE_PAM=y
 
 INCLUDE_DIRS= -I../include
 
@@ -84,14 +84,12 @@
 CFLAGS   += -DLOCKLIB=1
 endif
 
-INSTALL= install -o root
+INSTALL= install
 
 install: pppd
 	mkdir -p $(BINDIR) $(MANDIR)
-	$(INSTALL) -s -c -m 4550 pppd $(BINDIR)/pppd
-	if ! chgrp pppusers $(BINDIR)/pppd 2>/dev/null; then \
-	  chmod o+rx $(BINDIR)/pppd; fi
-	$(INSTALL) -c -m 444 pppd.8 $(MANDIR)/man8
+	$(INSTALL) -s pppd $(BINDIR)/pppd
+	$(INSTALL) pppd.8 $(MANDIR)/man8
 
 pppd: $(PPPDOBJS)
 	$(CC) $(CFLAGS) -o pppd $(PPPDOBJS) $(LIBS)
diff -urN ppp-2.3.9.orig/pppdump/Makefile.linux ppp-2.3.9/pppdump/Makefile.linux
--- ppp-2.3.9.orig/pppdump/Makefile.linux	Fri Aug 13 15:59:39 1999
+++ ppp-2.3.9/pppdump/Makefile.linux	Fri Aug 13 16:12:41 1999
@@ -6,7 +6,7 @@
 all:	pppdump
 
 pppdump: $(OBJS)
-	$(CC) -o pppdump $(OBJS)
+	$(CC) $(RPM_OPT_FLAGS) -o pppdump $(OBJS)
 
 clean:
 	rm -f pppdump $(OBJS) *~
diff -urN ppp-2.3.9.orig/pppstats/Makefile.linux ppp-2.3.9/pppstats/Makefile.linux
--- ppp-2.3.9.orig/pppstats/Makefile.linux	Fri Aug 13 15:59:40 1999
+++ ppp-2.3.9/pppstats/Makefile.linux	Fri Aug 13 15:59:53 1999
@@ -6,12 +6,12 @@
 PPPSTATSRCS = pppstats.c
 PPPSTATOBJS = pppstats.o
 
-#CC = gcc
-COPTS = -O
+CC = gcc
+COPTS = $(RPM_OPT_FLAGS) -Wall
 COMPILE_FLAGS = -D_linux_ -I../include
 LIBS =
 
-INSTALL= install -o root -g daemon
+INSTALL= install # -o root -g daemon
 
 CFLAGS = $(COPTS) $(COMPILE_FLAGS)
 
